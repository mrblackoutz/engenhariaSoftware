@startuml
actor Cliente
boundary AfiliarGUI <<boundary>>
control ControladorAfiliar <<controller>>
collections "clientes : Cliente" as clientes
participant "Cliente" as cliente
participant TermosDeUso

Cliente -> AfiliarGUI : InformaDadosPessoais()
activate AfiliarGUI
AfiliarGUI -> ControladorAfiliar : SolicitarAfiliação(CPF, Nome, email)
activate ControladorAfiliar

ControladorAfiliar -> clientes : verificaSeValido(CPF, Nome, email)

alt ehValido
    ControladorAfiliar -> AfiliarGUI : PedirVerificacaoEmail()
    
    ControladorAfiliar -> clientes : solicitarNovaAfiliação(CPF, Nome, email)
    activate clientes

    clientes -> cliente : createNewCliente(CPF, Nome, email)
    activate cliente
    cliente --> clientes : retorna novo cliente
    deactivate cliente
    deactivate clientes

    ControladorAfiliar -> TermosDeUso : SolicitarTermos()
    TermosDeUso --> ControladorAfiliar : retorna termos
    ControladorAfiliar -> AfiliarGUI : ExibirTermosDeUso()

    alt Cliente aceita os termos
        Cliente -> AfiliarGUI : AceitaTermos()
        AfiliarGUI -> ControladorAfiliar : RegistrarAceite()

        ControladorAfiliar -> cliente : registrarAceite()
        activate cliente
        cliente --> ControladorAfiliar : confirmação
        deactivate cliente

        ControladorAfiliar -> AfiliarGUI : ExibirSucessoAfiliação()

    else Cliente recusa os termos
        Cliente -> AfiliarGUI : RecusaTermos()
        AfiliarGUI -> ControladorAfiliar : CancelarAfiliação()

        ControladorAfiliar -> clientes : solicitarExclusao(cliente)
        activate clientes
        clientes -> cliente : excluir()
        cliente --> clientes : confirmação
        deactivate clientes

        ControladorAfiliar -> AfiliarGUI : ExibirCancelamento()
    end

else
    ControladorAfiliar -> AfiliarGUI : ExibirErroValidacao()
end

deactivate ControladorAfiliar
deactivate AfiliarGUI
@enduml
